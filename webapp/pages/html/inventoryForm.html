<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>inventory</title>
<link rel="stylesheet" href="../layui/css/layui.css">
<script src="../layui/layui.js"></script>
</head>
<body>
<div class="demoTable">
			&nbsp; 搜索材料：
			<div class="layui-inline">
				<input class="layui-input" name="keyword" id="demoReload" autocomplete="off">
			</div>
			<button class="layui-btn" data-type="reload" id="earsy">搜索</button>

			<button class="layui-btn layui-btn-normal layui-btn-radius" onclick="addMetrail()">添加</button>
			<button class="layui-btn layui-btn-normal layui-btn-radius" data-type="getCheckData" id="deletemes">批量删除</button>
		</div>

		<table class="layui-hide" id="demo" lay-filter="demome"></table>
		<script type="text/html" id="barDemo">
			<a class="layui-btn layui-btn-primary layui-btn-mini" lay-event="detail">查看</a>
			<a class="layui-btn layui-btn-mini" lay-event="edit">编辑</a>
			<a class="layui-btn layui-btn-danger layui-btn-mini" lay-event="del">删除</a>
		</script>
		<div style="width: 400px;" id="divwin">
			<form class="layui-form" id="dateupadd" lay-filter="dateupadd">

				<div class="layui-form-item">
					<label class="layui-form-label">商品名称</label>
					<div class="layui-input-block">
						<input type="hidden" name="productId" id="meterialId" />
						<input id="hhh" style="width: 200px;" type="text" name="productName" required lay-verify="required" placeholder="请输入商品名称" autocomplete="off" class="layui-input"></div>
				</div>
				<div class="layui-form-item">
					<label class="layui-form-label">商品售价</label>
					<div class="layui-input-block"><input style="width: 200px;" type="text" name="prodectSell" required lay-verify="required" placeholder="请输入商品售价" autocomplete="off" class="layui-input"></div>
				</div>
				<div class="layui-form-item">
					<label class="layui-form-label">商品备注</label>
					<div class="layui-input-block"><input style="width: 200px;" type="text" name="prodectdRemark" required lay-verify="required" placeholder="请输入商品备注" autocomplete="off" class="layui-input"></div>
				</div>
				<div class="layui-form-item">
					<label class="layui-form-label">商品分类</label>
					<div class="layui-input-block"><input style="width: 200px;" type="text" name="typeDataId" required lay-verify="required" placeholder="请输入商品分类" autocomplete="off" class="layui-input"></div>
				</div>
				<div class="layui-form-item">
					<label class="layui-form-label">原料表中配方id</label>
					<div class="layui-input-block"><input style="width: 200px;" type="text" name="recipeId" required lay-verify="required" placeholder="原料表中配方id" autocomplete="off" class="layui-input"></div>
				</div>
				<label class="layui-form-label">是否下架</label>
				<div class="layui-input-block">
					<input type="checkbox" name="prodectState" title="是" value="1" checked>
					<!--<input style="width: 200px;" type="text" name="prodectState" required lay-verify="required" placeholder="是否下架" autocomplete="off" class="layui-input"></div>-->
				</div>

				<div class="layui-form-item">
					<div class="layui-input-block">
						<button class="layui-btn" lay-submit lay-filter="formDemo">立即提交</button>
						<button type="reset" class="layui-btn layui-btn-primary">重置</button>
					</div>
				</div>
			</form>
		</div>
</body>
<script type="text/javascript">
function addGoods() {
	//$('#addForm').serialize():只能将普通元素提交的数据转换为查询字符串
	key=value&key2=valu2...
	// console.log($('#addForm').serialize());//查询字符串
	key=value&key2=value
	//获取到表单中所有的参数数据(普通参数+文件域参数)
	var formData = new FormData($('#addForm')[0]);
	//发送异步请求
	$.ajax({
		url : '${ctx}/goods.action?method=add',
		type : 'POST',
		//表单中有文件域时，要做文件上传时，必须指定contentType: false,让
		jQuery能够支持 enctype="multipart/form-data"
		contentType : false,
		//表单中有文件域时，要将processData设为false，表示不要将文件域中的
		文件数据转换为字符串
		processData : false,
		//指定要发给服务器的参数,
		data : formData,
		dataType : 'text',
		success : function(data) {
			//console.log(data+',type:'+typeof data);
		//js会隐式调用Boolean()将'true'转换为true
		if(data){
				//关闭弹出层,当前iframe层所在窗口是列表页面窗口的子窗口
				var index = parent.layer.getFrameIndex(window.name); 
				//先得到当前iframe层的索引
				parent.layer.close(index);
			}						
		},
		complete:function(xhr,textStatus){
			    //重新请求列表页面
			    parent.location.href='${ctx}/goods.action?
			    method=queryByPage';
			    
		}
	})
}
</script>
</html>